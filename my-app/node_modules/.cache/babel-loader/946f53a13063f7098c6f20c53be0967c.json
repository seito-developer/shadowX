{"ast":null,"code":"let parser = require('postcss-selector-parser');\n\nfunction parse(str, rule) {\n  let nodes;\n  let saver = parser(parsed => {\n    nodes = parsed;\n  });\n\n  try {\n    saver.processSync(str);\n  } catch (e) {\n    if (str.includes(':')) {\n      throw rule ? rule.error('Missed semicolon') : e;\n    } else {\n      throw rule ? rule.error(e.message) : e;\n    }\n  }\n\n  return nodes.at(0);\n}\n\nfunction replace(nodes, parent) {\n  let replaced = false;\n  nodes.each(i => {\n    if (i.type === 'nesting') {\n      let clonedParent = parent.clone();\n\n      if (i.value !== '&') {\n        i.replaceWith(parse(i.value.replace('&', clonedParent.toString())));\n      } else {\n        i.replaceWith(clonedParent);\n      }\n\n      replaced = true;\n    } else if (i.nodes) {\n      if (replace(i, parent)) {\n        replaced = true;\n      }\n    }\n  });\n  return replaced;\n}\n\nfunction selectors(parent, child) {\n  let result = [];\n  parent.selectors.forEach(i => {\n    let parentNode = parse(i, parent);\n    child.selectors.forEach(j => {\n      if (j.length) {\n        let node = parse(j, child);\n        let replaced = replace(node, parentNode);\n\n        if (!replaced) {\n          node.prepend(parser.combinator({\n            value: ' '\n          }));\n          node.prepend(parentNode.clone());\n        }\n\n        result.push(node.toString());\n      }\n    });\n  });\n  return result;\n}\n\nfunction pickComment(comment, after) {\n  if (comment && comment.type === 'comment') {\n    after.after(comment);\n    return comment;\n  } else {\n    return after;\n  }\n}\n\nfunction atruleChilds(rule, atrule, bubbling) {\n  let children = [];\n  atrule.each(child => {\n    if (child.type === 'comment') {\n      children.push(child);\n    } else if (child.type === 'decl') {\n      children.push(child);\n    } else if (child.type === 'rule' && bubbling) {\n      child.selectors = selectors(rule, child);\n    } else if (child.type === 'atrule') {\n      atruleChilds(rule, child, bubbling);\n    }\n  });\n\n  if (bubbling) {\n    if (children.length) {\n      let clone = rule.clone({\n        nodes: []\n      });\n\n      for (let child of children) {\n        clone.append(child);\n      }\n\n      atrule.prepend(clone);\n    }\n  }\n}\n\nfunction pickDeclarations(selector, declarations, after, Rule) {\n  let parent = new Rule({\n    selector,\n    nodes: []\n  });\n\n  for (let declaration of declarations) {\n    parent.append(declaration);\n  }\n\n  after.after(parent);\n  return parent;\n}\n\nfunction atruleNames(defaults, custom) {\n  let list = {};\n\n  for (let i of defaults) {\n    list[i] = true;\n  }\n\n  if (custom) {\n    for (let i of custom) {\n      let name = i.replace(/^@/, '');\n      list[name] = true;\n    }\n  }\n\n  return list;\n}\n\nmodule.exports = (opts = {}) => {\n  let bubble = atruleNames(['media', 'supports'], opts.bubble);\n  let unwrap = atruleNames(['document', 'font-face', 'keyframes', '-webkit-keyframes', '-moz-keyframes'], opts.unwrap);\n  let preserveEmpty = opts.preserveEmpty;\n  return {\n    postcssPlugin: 'postcss-nested',\n\n    Rule(rule, {\n      Rule\n    }) {\n      let unwrapped = false;\n      let after = rule;\n      let copyDeclarations = false;\n      let declarations = [];\n      rule.each(child => {\n        if (child.type === 'rule') {\n          if (declarations.length) {\n            after = pickDeclarations(rule.selector, declarations, after, Rule);\n            declarations = [];\n          }\n\n          copyDeclarations = true;\n          unwrapped = true;\n          child.selectors = selectors(rule, child);\n          after = pickComment(child.prev(), after);\n          after.after(child);\n          after = child;\n        } else if (child.type === 'atrule') {\n          if (declarations.length) {\n            after = pickDeclarations(rule.selector, declarations, after, Rule);\n            declarations = [];\n          }\n\n          if (child.name === 'at-root') {\n            unwrapped = true;\n            atruleChilds(rule, child, false);\n            let nodes = child.nodes;\n\n            if (child.params) {\n              nodes = new Rule({\n                selector: child.params,\n                nodes\n              });\n            }\n\n            after.after(nodes);\n            after = nodes;\n            child.remove();\n          } else if (bubble[child.name]) {\n            copyDeclarations = true;\n            unwrapped = true;\n            atruleChilds(rule, child, true);\n            after = pickComment(child.prev(), after);\n            after.after(child);\n            after = child;\n          } else if (unwrap[child.name]) {\n            copyDeclarations = true;\n            unwrapped = true;\n            atruleChilds(rule, child, false);\n            after = pickComment(child.prev(), after);\n            after.after(child);\n            after = child;\n          } else if (copyDeclarations) {\n            declarations.push(child);\n          }\n        } else if (child.type === 'decl' && copyDeclarations) {\n          declarations.push(child);\n        }\n      });\n\n      if (declarations.length) {\n        after = pickDeclarations(rule.selector, declarations, after, Rule);\n      }\n\n      if (unwrapped && preserveEmpty !== true) {\n        rule.raws.semicolon = true;\n        if (rule.nodes.length === 0) rule.remove();\n      }\n    }\n\n  };\n};\n\nmodule.exports.postcss = true;","map":{"version":3,"sources":["/Users/seito/Documents/develop/count-jp/my-app/node_modules/postcss-nested/index.js"],"names":["parser","require","parse","str","rule","nodes","saver","parsed","processSync","e","includes","error","message","at","replace","parent","replaced","each","i","type","clonedParent","clone","value","replaceWith","toString","selectors","child","result","forEach","parentNode","j","length","node","prepend","combinator","push","pickComment","comment","after","atruleChilds","atrule","bubbling","children","append","pickDeclarations","selector","declarations","Rule","declaration","atruleNames","defaults","custom","list","name","module","exports","opts","bubble","unwrap","preserveEmpty","postcssPlugin","unwrapped","copyDeclarations","prev","params","remove","raws","semicolon","postcss"],"mappings":"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","sourcesContent":["let parser = require('postcss-selector-parser')\n\nfunction parse (str, rule) {\n  let nodes\n  let saver = parser(parsed => {\n    nodes = parsed\n  })\n  try {\n    saver.processSync(str)\n  } catch (e) {\n    if (str.includes(':')) {\n      throw rule ? rule.error('Missed semicolon') : e\n    } else {\n      throw rule ? rule.error(e.message) : e\n    }\n  }\n  return nodes.at(0)\n}\n\nfunction replace (nodes, parent) {\n  let replaced = false\n  nodes.each(i => {\n    if (i.type === 'nesting') {\n      let clonedParent = parent.clone()\n      if (i.value !== '&') {\n        i.replaceWith(parse(i.value.replace('&', clonedParent.toString())))\n      } else {\n        i.replaceWith(clonedParent)\n      }\n      replaced = true\n    } else if (i.nodes) {\n      if (replace(i, parent)) {\n        replaced = true\n      }\n    }\n  })\n  return replaced\n}\n\nfunction selectors (parent, child) {\n  let result = []\n  parent.selectors.forEach(i => {\n    let parentNode = parse(i, parent)\n\n    child.selectors.forEach(j => {\n      if (j.length) {\n        let node = parse(j, child)\n        let replaced = replace(node, parentNode)\n        if (!replaced) {\n          node.prepend(parser.combinator({ value: ' ' }))\n          node.prepend(parentNode.clone())\n        }\n        result.push(node.toString())\n      }\n    })\n  })\n  return result\n}\n\nfunction pickComment (comment, after) {\n  if (comment && comment.type === 'comment') {\n    after.after(comment)\n    return comment\n  } else {\n    return after\n  }\n}\n\nfunction atruleChilds (rule, atrule, bubbling) {\n  let children = []\n  atrule.each(child => {\n    if (child.type === 'comment') {\n      children.push(child)\n    } else if (child.type === 'decl') {\n      children.push(child)\n    } else if (child.type === 'rule' && bubbling) {\n      child.selectors = selectors(rule, child)\n    } else if (child.type === 'atrule') {\n      atruleChilds(rule, child, bubbling)\n    }\n  })\n  if (bubbling) {\n    if (children.length) {\n      let clone = rule.clone({ nodes: [] })\n      for (let child of children) {\n        clone.append(child)\n      }\n      atrule.prepend(clone)\n    }\n  }\n}\n\nfunction pickDeclarations (selector, declarations, after, Rule) {\n  let parent = new Rule({\n    selector,\n    nodes: []\n  })\n\n  for (let declaration of declarations) {\n    parent.append(declaration)\n  }\n\n  after.after(parent)\n  return parent\n}\n\nfunction atruleNames (defaults, custom) {\n  let list = {}\n  for (let i of defaults) {\n    list[i] = true\n  }\n  if (custom) {\n    for (let i of custom) {\n      let name = i.replace(/^@/, '')\n      list[name] = true\n    }\n  }\n  return list\n}\n\nmodule.exports = (opts = {}) => {\n  let bubble = atruleNames(['media', 'supports'], opts.bubble)\n  let unwrap = atruleNames(\n    [\n      'document',\n      'font-face',\n      'keyframes',\n      '-webkit-keyframes',\n      '-moz-keyframes'\n    ],\n    opts.unwrap\n  )\n  let preserveEmpty = opts.preserveEmpty\n\n  return {\n    postcssPlugin: 'postcss-nested',\n    Rule (rule, { Rule }) {\n      let unwrapped = false\n      let after = rule\n      let copyDeclarations = false\n      let declarations = []\n\n      rule.each(child => {\n        if (child.type === 'rule') {\n          if (declarations.length) {\n            after = pickDeclarations(rule.selector, declarations, after, Rule)\n            declarations = []\n          }\n\n          copyDeclarations = true\n          unwrapped = true\n          child.selectors = selectors(rule, child)\n          after = pickComment(child.prev(), after)\n          after.after(child)\n          after = child\n        } else if (child.type === 'atrule') {\n          if (declarations.length) {\n            after = pickDeclarations(rule.selector, declarations, after, Rule)\n            declarations = []\n          }\n\n          if (child.name === 'at-root') {\n            unwrapped = true\n            atruleChilds(rule, child, false)\n\n            let nodes = child.nodes\n            if (child.params) {\n              nodes = new Rule({ selector: child.params, nodes })\n            }\n\n            after.after(nodes)\n            after = nodes\n            child.remove()\n          } else if (bubble[child.name]) {\n            copyDeclarations = true\n            unwrapped = true\n            atruleChilds(rule, child, true)\n            after = pickComment(child.prev(), after)\n            after.after(child)\n            after = child\n          } else if (unwrap[child.name]) {\n            copyDeclarations = true\n            unwrapped = true\n            atruleChilds(rule, child, false)\n            after = pickComment(child.prev(), after)\n            after.after(child)\n            after = child\n          } else if (copyDeclarations) {\n            declarations.push(child)\n          }\n        } else if (child.type === 'decl' && copyDeclarations) {\n          declarations.push(child)\n        }\n      })\n\n      if (declarations.length) {\n        after = pickDeclarations(rule.selector, declarations, after, Rule)\n      }\n\n      if (unwrapped && preserveEmpty !== true) {\n        rule.raws.semicolon = true\n        if (rule.nodes.length === 0) rule.remove()\n      }\n    }\n  }\n}\nmodule.exports.postcss = true\n"]},"metadata":{},"sourceType":"script"}